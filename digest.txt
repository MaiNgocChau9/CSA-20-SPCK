Directory structure:
‚îî‚îÄ‚îÄ CSA-20-SPCK/
    ‚îú‚îÄ‚îÄ README.md
    ‚îú‚îÄ‚îÄ app.py
    ‚îú‚îÄ‚îÄ disease-prediction-from-weather.ipynb
    ‚îú‚îÄ‚îÄ file.ipynb
    ‚îú‚îÄ‚îÄ requirements.txt
    ‚îú‚îÄ‚îÄ test.py
    ‚îú‚îÄ‚îÄ update-dataset.py
    ‚îú‚îÄ‚îÄ weather_information.ipynb
    ‚îî‚îÄ‚îÄ data/
        ‚îî‚îÄ‚îÄ global_climate_health_impact_tracker_2015_2025.csv
        ‚îî‚îÄ‚îÄ GlobalWeatherRepository.csv

================================================
FILE: README.md
================================================
# CSA-20-SPCK

## Quick start

1. Create a virtual environment and install dependencies:

```bash
python -m venv .venv
source .venv/bin/activate    # or `.venv\Scripts\activate` on Windows
pip install -r requirements.txt
```

2. Run the app:

```bash
streamlit run app.py
```

Files:
- `app.py` √¢‚Ç¨‚Äù main page
- `pages/1_Data_Analysis.py` √¢‚Ç¨‚Äù data exploration
- `pages/2_Input_Record.py` √¢‚Ç¨‚Äù append rows to CSV
- `pages/3_Prediction.py` √¢‚Ç¨‚Äù simple training / evaluation / predict
- `datamodules/DataModule.py` √¢‚Ç¨‚Äù minimal helper to read/visualize CSV
- `config.py` √¢‚Ç¨‚Äù path constants


================================================
FILE: app.py
================================================
Error reading file with 'cp1252': 'charmap' codec can't decode byte 0x9d in position 1267: character maps to <undefined>


================================================
FILE: disease-prediction-from-weather.ipynb
================================================
# Jupyter notebook converted to Python script.

"""
# D·ª± ƒëo√°n c√°c cƒÉn b·ªánh d·ª±a tr√™n d·ªØ li·ªáu th·ªùi ti·∫øt v√† kh√≠ h·∫≠u

Notebook n√†y h∆∞·ªõng d·∫´n quy tr√¨nh d·ª± ƒëo√°n c√°c cƒÉn b·ªánh c√≥ th·ªÉ x·∫£y ra d·ª±a tr√™n d·ªØ li·ªáu th·ªùi ti·∫øt v√† s·ª©c kh·ªèe t·ª´ file `global_climate_health_impact_tracker_2015_2025.csv`.
"""

"""
### üéØ M·ª•c ti√™u d·ª± ƒëo√°n c·ªßa d·ª± √°n

* D·ª± ƒëo√°n **t·ª∑ l·ªá b·ªánh h√¥ h·∫•p (respiratory_disease_rate)** t·ª´ pm25 v√† air_quality_index.
* D·ª± ƒëo√°n **ch·ªâ s·ªë r·ªßi ro b·ªánh truy·ªÅn qua vector (vector_disease_risk_score)** t·ª´ temperature_celsius, precipitation_mm v√† heat_related_admissions.
* D·ª± ƒëo√°n **s·ªë ca nh·∫≠p vi·ªán do n·∫Øng n√≥ng (heat_related_admissions)** t·ª´ temperature_celsius, precipitation_mm, heat_wave_days v√† extreme_weather_events.
"""

"""
## 1. Import th∆∞ vi·ªán c·∫ßn thi·∫øt v√† t·∫£i d·ªØ li·ªáu

- S·ª≠ d·ª•ng pandas, numpy, matplotlib, seaborn, scikit-learn.
- ƒê·ªçc file `global_climate_health_impact_tracker_2015_2025.csv` v√†o DataFrame.
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

# TRAIN
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error, r2_score
from sklearn.ensemble import RandomForestRegressor

df = pd.read_csv('data/global_climate_health_impact_tracker_2015_2025.csv')

print('Health rows,cols:', df.shape)
df.head()
df.columns
# Output:
#   Health rows,cols: (14100, 30)

#   Index(['record_id', 'country_code', 'country_name', 'region', 'income_level',

#          'date', 'year', 'month', 'week', 'latitude', 'longitude',

#          'population_millions', 'temperature_celsius', 'temp_anomaly_celsius',

#          'precipitation_mm', 'heat_wave_days', 'drought_indicator',

#          'flood_indicator', 'extreme_weather_events', 'pm25_ugm3',

#          'air_quality_index', 'respiratory_disease_rate',

#          'cardio_mortality_rate', 'vector_disease_risk_score',

#          'waterborne_disease_incidents', 'heat_related_admissions',

#          'healthcare_access_index', 'gdp_per_capita_usd', 'mental_health_index',

#          'food_security_index'],

#         dtype='object')

"""
## Heatmap
"""

import seaborn as sns

# Select only numeric columns for heatmap
numeric_df = df.select_dtypes(include=[np.number])

# Create heatmap
plt.figure(figsize=(16, 12))
sns.heatmap(numeric_df.corr(), annot=True, cmap='coolwarm', center=0, fmt='.2f', cbar_kws={'label': 'Correlation'})
plt.title('Correlation Heatmap - Climate and Health Variables')
plt.tight_layout()
plt.show()
# Output:
#   <Figure size 1600x1200 with 2 Axes>

"""
Ta s·∫Ω hu·∫•n luy·ªán m√¥ h√¨nh v·ªÅ c√°c v·∫•n ƒë·ªÅ s·ª©c d·ª±a tr√™n c√°c bi·∫øn c√≥ h·ªá s·ªë t∆∞∆°ng quan m·∫°nh:
```
respiratory_disease_rate: pm25, air_qulity_index
vector_disease_risk_score: temperature_celsius, precipitation_mm, heat_ralated_adminssions
heat_related_admissions: temperature_celsius, precipitation_mm, heat_wave_days, extreme_weahter_events
```
"""

# Model 1: respiratory_disease_rate
features = ['pm25_ugm3', 'air_quality_index']
target = 'respiratory_disease_rate'

X = numeric_df[features].dropna()
y = numeric_df[target].dropna()
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
# Random Forest Regressor
forestmodel_respiratory_disease_rate = RandomForestRegressor(n_estimators=100, random_state=42)
forestmodel_respiratory_disease_rate.fit(X_train, y_train)
y_pred = forestmodel_respiratory_disease_rate.predict(X_test)
mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print(mse, r2)

# V·∫Ω bi·ªÉu ƒë·ªì so s√°nh gi√° tr·ªã th·ª±c v√† gi√° tr·ªã d·ª± ƒëo√°n
plt.figure(figsize=(10, 6))
plt.scatter(y_test, y_pred, color='blue', alpha=0.6)
plt.plot([y.min(), y.max()], [y.min(), y.max()], 'k--', lw=2, color='red')
plt.xlabel('[Forest] Actual Respiratory Disease Rate')

# Linear Regression
linmodel_respiratory_disease_rate = LinearRegression()
linmodel_respiratory_disease_rate.fit(X_train, y_train)
y_pred = linmodel_respiratory_disease_rate.predict(X_test)

mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)
print(mse, r2)

# => Linear Regression gives better result

# V·∫Ω bi·ªÉu ƒë·ªì so s√°nh gi√° tr·ªã th·ª±c v√† gi√° tr·ªã d·ª± ƒëo√°n
plt.figure(figsize=(10, 6))
plt.scatter(y_test, y_pred, color='blue', alpha=0.6)
plt.plot([y.min(), y.max()], [y.min(), y.max()], 'k--', lw=2, color='red')
plt.xlabel('[Linear] Actual Respiratory Disease Rate')
# Output:
#   124.43407412462824 0.4731846820713371

#   98.27108957067846 0.5839506529094147

#   C:\Users\lenovo\AppData\Local\Temp\ipykernel_11008\4182802223.py:20: UserWarning: color is redundantly defined by the 'color' keyword argument and the fmt string "k--" (-> color='k'). The keyword argument will take precedence.

#     plt.plot([y.min(), y.max()], [y.min(), y.max()], 'k--', lw=2, color='red')

#   C:\Users\lenovo\AppData\Local\Temp\ipykernel_11008\4182802223.py:37: UserWarning: color is redundantly defined by the 'color' keyword argument and the fmt string "k--" (-> color='k'). The keyword argument will take precedence.

#     plt.plot([y.min(), y.max()], [y.min(), y.max()], 'k--', lw=2, color='red')

#   Text(0.5, 0, '[Linear] Actual Respiratory Disease Rate')
#   <Figure size 1000x600 with 1 Axes>
#   <Figure size 1000x600 with 1 Axes>

# Model 2: vector_disease_risk_score
features = ['temperature_celsius', 'precipitation_mm', 'heat_related_admissions']
target = 'vector_disease_risk_score'

X = numeric_df[features].dropna()
y = numeric_df[target].dropna()
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
# Random Forest Regressor
forestmodel_vector_disease_risk_score = RandomForestRegressor(n_estimators=100, random_state=42)
forestmodel_vector_disease_risk_score.fit(X_train, y_train)

y_pred = forestmodel_vector_disease_risk_score.predict(X_test)
mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print(mse, r2)

# V·∫Ω bi·ªÉu ƒë·ªì so s√°nh gi√° tr·ªã th·ª±c v√† gi√° tr·ªã d·ª± ƒëo√°n
plt.figure(figsize=(10, 6))
plt.scatter(y_test, y_pred, color='blue', alpha=0.6)
plt.plot([y.min(), y.max()], [y.min(), y.max()], 'k--', lw=2, color='red')
plt.xlabel('[Forest] Actual Vector Disease Risk Score')

# Linear Regression
linmodel_vector_disease_risk_score = LinearRegression()
linmodel_vector_disease_risk_score.fit(X_train, y_train)
y_pred = linmodel_vector_disease_risk_score.predict(X_test)

mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print(mse, r2)

# => Random Forest works better

# V·∫Ω bi·ªÉu ƒë·ªì so s√°nh gi√° tr·ªã th·ª±c v√† gi√° tr·ªã d·ª± ƒëo√°n
plt.figure(figsize=(10, 6))
plt.scatter(y_test, y_pred, color='blue', alpha=0.6)
plt.plot([y.min(), y.max()], [y.min(), y.max()], 'k--', lw=2, color='red')
plt.xlabel('[Forest] Actual Vector Disease Risk Score')
# Output:
#   26.728699387464673 0.9085955048517242

#   167.66238722177977 0.4266426646053446

#   C:\Users\lenovo\AppData\Local\Temp\ipykernel_11008\829019743.py:21: UserWarning: color is redundantly defined by the 'color' keyword argument and the fmt string "k--" (-> color='k'). The keyword argument will take precedence.

#     plt.plot([y.min(), y.max()], [y.min(), y.max()], 'k--', lw=2, color='red')

#   C:\Users\lenovo\AppData\Local\Temp\ipykernel_11008\829019743.py:39: UserWarning: color is redundantly defined by the 'color' keyword argument and the fmt string "k--" (-> color='k'). The keyword argument will take precedence.

#     plt.plot([y.min(), y.max()], [y.min(), y.max()], 'k--', lw=2, color='red')

#   Text(0.5, 0, '[Forest] Actual Vector Disease Risk Score')
#   <Figure size 1000x600 with 1 Axes>
#   <Figure size 1000x600 with 1 Axes>

# Model 3: heat_related_admissions
features = ['temperature_celsius', 'precipitation_mm', 'heat_wave_days', 'extreme_weather_events']
target = 'heat_related_admissions'

X = numeric_df[features].dropna()
y = numeric_df[target].dropna()
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
# Random Forest Regressor
forestmodel_heat_related_admissions = RandomForestRegressor(n_estimators=100, random_state=42)
forestmodel_heat_related_admissions.fit(X_train, y_train)

y_pred = forestmodel_heat_related_admissions.predict(X_test)
mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print(mse, r2)

# V·∫Ω bi·ªÉu ƒë·ªì so s√°nh gi√° tr·ªã th·ª±c v√† gi√° tr·ªã d·ª± ƒëo√°n
plt.figure(figsize=(10, 6))
plt.scatter(y_test, y_pred, color='blue', alpha=0.6)
plt.plot([y.min(), y.max()], [y.min(), y.max()], 'k--', lw=2, color='red')
plt.xlabel('[Forest] Actual Heat Related Admissions')

# Linear Regression
linmodel_heat_related_admissions = LinearRegression()
linmodel_heat_related_admissions.fit(X_train, y_train)
y_pred = linmodel_heat_related_admissions.predict(X_test)

mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)
print(mse, r2)

# => Linear Regression gives better results in all 3 cases

# V·∫Ω bi·ªÉu ƒë·ªì so s√°nh gi√° tr·ªã th·ª±c v√† gi√° tr·ªã d·ª± ƒëo√°n
plt.figure(figsize=(10, 6))
plt.scatter(y_test, y_pred, color='blue', alpha=0.6)
plt.plot([y.min(), y.max()], [y.min(), y.max()], 'k--', lw=2, color='red')
plt.xlabel('[Linear] Actual Heat Related Admissions')
# Output:
#   33.804759416352844 0.6032112770481663

#   31.2797548416442 0.6328489185502538

#   C:\Users\lenovo\AppData\Local\Temp\ipykernel_11008\4292638018.py:21: UserWarning: color is redundantly defined by the 'color' keyword argument and the fmt string "k--" (-> color='k'). The keyword argument will take precedence.

#     plt.plot([y.min(), y.max()], [y.min(), y.max()], 'k--', lw=2, color='red')

#   C:\Users\lenovo\AppData\Local\Temp\ipykernel_11008\4292638018.py:38: UserWarning: color is redundantly defined by the 'color' keyword argument and the fmt string "k--" (-> color='k'). The keyword argument will take precedence.

#     plt.plot([y.min(), y.max()], [y.min(), y.max()], 'k--', lw=2, color='red')

#   Text(0.5, 0, '[Linear] Actual Heat Related Admissions')
#   <Figure size 1000x600 with 1 Axes>
#   <Figure size 1000x600 with 1 Axes>



================================================
FILE: file.ipynb
================================================
# Jupyter notebook converted to Python script.

"""
# B√ÅO C√ÅO PH√ÇN T√çCH TO√ÄN DI·ªÜN: KH√ç H·∫¨U V√Ä S·ª®C KH·ªéE TO√ÄN C·∫¶U
**D·ªØ li·ªáu s·ª≠ d·ª•ng:** GlobalWeatherRepository & Climate Health Impact Tracker  

---
## üéØ M·ª•c ti√™u Ph√¢n t√≠ch
1. **Ph√¢n t√≠ch Kh√≠ h·∫≠u:** S·ª≠ d·ª•ng d·ªØ li·ªáu tr·∫°m ƒëo ƒë·ªÉ t√¨m ra c√°c ki·ªÉu th·ªùi ti·∫øt ph·ªï bi·∫øn v√† y·∫øu t·ªë chi ph·ªëi nhi·ªát ƒë·ªô.
2. **Ph√¢n t√≠ch S·ª©c kh·ªèe:** K·∫øt n·ªëi s·ª± bi·∫øn ƒë·ªïi kh√≠ h·∫≠u v·ªõi c√°c h·ªôi ch·ª©ng s·ªëc nhi·ªát v√† r·ªßi ro d·ªãch b·ªánh.
3. **M√¥ h√¨nh D·ª± b√°o:** Th·∫©m ƒë·ªãnh kh·∫£ nƒÉng d·ª± b√°o r·ªßi ro d·ª±a tr√™n k·ªãch b·∫£n th·ªùi ti·∫øt gi·∫£ l·∫≠p.
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

# C·∫•u h√¨nh giao di·ªán
sns.set_theme(style="whitegrid")
plt.rcParams['figure.figsize'] = (12, 6)
plt.rcParams['axes.titlesize'] = 15

# 1. T·∫£i d·ªØ li·ªáu
try:
    # File 1: D·ªØ li·ªáu th·ªùi ti·∫øt chi ti·∫øt
    df_weather = pd.read_csv('data/GlobalWeatherRepository.csv')
    # File 2: D·ªØ li·ªáu t√°c ƒë·ªông s·ª©c kh·ªèe
    df_health = pd.read_csv('data/global_climate_health_impact_tracker_2015_2025.csv')
    
    print(f"‚úÖ T·∫£i th√†nh c√¥ng Weather Data: {df_weather.shape[0]} d√≤ng")
    print(f"‚úÖ T·∫£i th√†nh c√¥ng Health Data: {df_health.shape[0]} d√≤ng")
except FileNotFoundError as e:
    print(f"‚ùå L·ªói: Kh√¥ng t√¨m th·∫•y file. Chi ti·∫øt: {e}")
# Output:
#   ‚úÖ T·∫£i th√†nh c√¥ng Weather Data: 120042 d√≤ng

#   ‚úÖ T·∫£i th√†nh c√¥ng Health Data: 14100 d√≤ng


"""
## 1. PH√ÇN T√çCH C√ÅC Y·∫æU T·ªê KH√ç T∆Ø·ª¢NG
Ch√∫ng ta s·∫Ω t√¨m hi·ªÉu xem ƒëi·ªÅu g√¨ ƒëang th·ª±c s·ª± x·∫£y ra v·ªõi b·∫ßu kh√≠ quy·ªÉn th√¥ng qua d·ªØ li·ªáu t·ª´ c√°c tr·∫°m quan tr·∫Øc.
"""

# 1.1 Top 10 ƒëi·ªÅu ki·ªán th·ªùi ti·∫øt ph·ªï bi·∫øn nh·∫•t th·∫ø gi·ªõi
plt.figure(figsize=(12, 6))
top_conditions = df_weather['condition_text'].value_counts().head(10)
sns.barplot(x=top_conditions.values, y=top_conditions.index, palette='viridis')
plt.title('Top 10 ƒêi·ªÅu ki·ªán Th·ªùi ti·∫øt Ph·ªï bi·∫øn nh·∫•t')
plt.xlabel('S·ªë l∆∞·ª£ng tr·∫°m ƒëo ghi nh·∫≠n')
plt.show()
# Output:
#   C:\Users\lenovo\AppData\Local\Temp\ipykernel_4948\1809199951.py:4: FutureWarning: 

#   

#   Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.

#   

#     sns.barplot(x=top_conditions.values, y=top_conditions.index, palette='viridis')

#   <Figure size 1200x600 with 1 Axes>

# 1.2 Y·∫øu t·ªë n√†o ·∫£nh h∆∞·ªüng ƒë·∫øn Nhi·ªát ƒë·ªô nh·∫•t?
# Ch·ªçn c√°c c·ªôt c·∫£m bi·∫øn t·ª´ GlobalWeatherRepository
features = ['humidity', 'pressure_mb', 'wind_kph', 'cloud', 'precip_mm', 'latitude']
X = df_weather[features].fillna(0)
y = df_weather['temperature_celsius']

model_rf = RandomForestRegressor(n_estimators=50, random_state=42)
model_rf.fit(X, y)

# V·∫Ω bi·ªÉu ƒë·ªì m·ª©c ƒë·ªô quan tr·ªçng
imp_df = pd.DataFrame({'Y·∫øu t·ªë': features, 'M·ª©c ƒë·ªô ·∫£nh h∆∞·ªüng': model_rf.feature_importances_}).sort_values('M·ª©c ƒë·ªô ·∫£nh h∆∞·ªüng')
plt.barh(imp_df['Y·∫øu t·ªë'], imp_df['M·ª©c ƒë·ªô ·∫£nh h∆∞·ªüng'], color='salmon')
plt.title('Y·∫øu t·ªë t√°c ƒë·ªông l·ªõn nh·∫•t ƒë·∫øn Nhi·ªát ƒë·ªô (Ph√¢n t√≠ch t·ª´ Tr·∫°m ƒëo)')
plt.show()
print("Nh·∫≠n x√©t: Vƒ© ƒë·ªô v√† ƒê·ªô ·∫©m l√† nh·ªØng bi·∫øn s·ªë chi ph·ªëi nhi·ªát ƒë·ªô m·∫°nh nh·∫•t.")
# Output:
#   <Figure size 1200x600 with 1 Axes>
#   Nh·∫≠n x√©t: Vƒ© ƒë·ªô v√† ƒê·ªô ·∫©m l√† nh·ªØng bi·∫øn s·ªë chi ph·ªëi nhi·ªát ƒë·ªô m·∫°nh nh·∫•t.


"""
## 2. S·ªêC NHI·ªÜT
S·ª≠ d·ª•ng d·ªØ li·ªáu Health Impact ƒë·ªÉ ph√¢n t√≠ch ng∆∞·ª°ng ch·ªãu ƒë·ª±ng c·ªßa con ng∆∞·ªùi khi nhi·ªát ƒë·ªô tƒÉng cao.
"""

# 2.1 Bi·ªÉu ƒë·ªì xu h∆∞·ªõng nhi·ªát ƒë·ªô to√†n c·∫ßu qua c√°c nƒÉm
yearly_temp = df_health.groupby('year')['temperature_celsius'].mean()
plt.plot(yearly_temp.index, yearly_temp.values, marker='s', color='darkred', linestyle='--')
plt.title('Xu h∆∞·ªõng N√≥ng l√™n To√†n c·∫ßu (2015 - 2025)')
plt.ylabel('Nhi·ªát ƒë·ªô TB (¬∞C)')
plt.show()
# Output:
#   <Figure size 1200x600 with 1 Axes>

# 2.2 Ph√¢n t√≠ch S·ªëc nhi·ªát: T√¨m ng∆∞·ª°ng g√£y (Tipping Point)
plt.figure(figsize=(10, 6))
sns.scatterplot(data=df_health, x='temperature_celsius', y='heat_related_admissions', alpha=0.3, color='orange')
plt.axvline(x=30, color='red', linestyle='--', label='Ng∆∞·ª°ng Nguy hi·ªÉm (30¬∞C)')
plt.title('M·ªëi li√™n h·ªá gi·ªØa Nhi·ªát ƒë·ªô v√† S·ªë ca c·∫•p c·ª©u do S·ªëc nhi·ªát')
plt.legend()
plt.show()
print("Nh·∫≠n x√©t: Sau m·ªëc 30¬∞C, s·ªë ca nh·∫≠p vi·ªán tƒÉng v·ªçt, ch·ª©ng t·ªè ƒë√¢y l√† gi·ªõi h·∫°n ch·ªãu nhi·ªát c·ªßa c∆° th·ªÉ.")
# Output:
#   <Figure size 1000x600 with 1 Axes>
#   Nh·∫≠n x√©t: Sau m·ªëc 30¬∞C, s·ªë ca nh·∫≠p vi·ªán tƒÉng v·ªçt, ch·ª©ng t·ªè ƒë√¢y l√† gi·ªõi h·∫°n ch·ªãu nhi·ªát c·ªßa c∆° th·ªÉ.


"""
## 3. D·ªäCH B·ªÜNH TRUY·ªÄN NHI·ªÑM
Ph√¢n t√≠ch xem t·∫°i sao s·ª± k·∫øt h·ª£p gi·ªØa n·∫Øng n√≥ng v√† m∆∞a nhi·ªÅu l·∫°i t·∫°o ra c√°c ·ªï d·ªãch.
"""

# 3.1 Ma tr·∫≠n r·ªßi ro: Nhi·ªát ƒë·ªô & L∆∞·ª£ng m∆∞a
plt.figure(figsize=(12, 7))
plt.scatter(df_health['temperature_celsius'], df_health['precipitation_mm'], 
            c=df_health['vector_disease_risk_score'], cmap='YlGnBu', alpha=0.5, s=50)
plt.colorbar(label='Ch·ªâ s·ªë R·ªßi ro D·ªãch b·ªánh')
plt.xlabel('Nhi·ªát ƒë·ªô (¬∞C)')
plt.ylabel('L∆∞·ª£ng m∆∞a (mm)')
plt.title('R·ªßi ro D·ªãch b·ªánh')
plt.show()
# Output:
#   <Figure size 1200x700 with 2 Axes>



================================================
FILE: requirements.txt
================================================
streamlit
pandas
plotly
scikit-learn
numpy


================================================
FILE: test.py
================================================
import streamlit as st
import pandas as pd
import numpy as np
from sklearn.linear_model import LinearRegression
from sklearn.ensemble import RandomForestRegressor
import plotly.express as px
import plotly.graph_objects as go
from plotly.subplots import make_subplots
import datetime
from datetime import timedelta

# --- 1. PAGE CONFIG & DARK THEME CSS ---
st.set_page_config(
    page_title="Climate Intelligence Platform",
    layout="wide",
    initial_sidebar_state="expanded",
    page_icon="‚õàÔ∏è"
)

# Custom CSS ƒë·ªÉ Dark Mode tr√¥ng "x·ªãn" h∆°n (Glassmorphism cards)
st.markdown("""
    <style>
    /* Ch·ªânh m√†u n·ªÅn t·ªïng th·ªÉ cho ƒë·ªìng b·ªô */
    .stApp {
        background-color: #0e1117;
    }
    
    /* Style l·∫°i c√°c Tabs */
    .stTabs [data-baseweb="tab-list"] {
        gap: 10px;
        border-bottom: 1px solid #2b313e;
    }
    .stTabs [data-baseweb="tab"] {
        height: 50px;
        background-color: transparent;
        color: #909090;
        border: none;
        font-weight: 500;
    }
    .stTabs [data-baseweb="tab"][aria-selected="true"] {
        color: #4da6ff;
        border-bottom: 2px solid #4da6ff;
    }
    
    /* Custom Metric Cards - Lo·∫°i b·ªè background tr·∫Øng, d√πng vi·ªÅn m·ªèng */
    div[data-testid="stMetric"] {
        background-color: #1a1c24;
        border: 1px solid #2b313e;
        padding: 15px;
        border-radius: 8px;
        color: white;
    }
    div[data-testid="stMetricLabel"] {
        color: #a0a0a0;
    }
    div[data-testid="stMetricValue"] {
        color: #ffffff;
        font-weight: 600;
    }
    
    /* ·∫®n b·ªõt padding th·ª´a */
    .block-container {
        padding-top: 2rem;
    }
    </style>
""", unsafe_allow_html=True)

# --- 2. DATA LOADING & SIMULATION ENGINE ---
@st.cache_data
def load_data():
    try:
        # Load d·ªØ li·ªáu g·ªëc
        df_health = pd.read_csv("data/global_climate_health_impact_tracker_2015_2025.csv")
        df_weather = pd.read_csv("data/GlobalWeatherRepository.csv")
        
        # Mapping region c∆° b·∫£n
        region_map = {
            'Vietnam': 'Asia', 'Japan': 'Asia', 'Thailand': 'Asia', 'India': 'Asia', 'China': 'Asia',
            'USA': 'North America', 'Canada': 'North America', 'France': 'Europe', 'Germany': 'Europe'
        }
        df_weather['Region'] = df_weather['country'].map(region_map).fillna('Other')
        return df_health, df_weather
    except Exception as e:
        st.error(f"Error loading data: {e}")
        return None, None

def generate_historical_data(base_row, days=30):
    """
    H√†m n√†y t·∫°o ra d·ªØ li·ªáu l·ªãch s·ª≠ gi·∫£ l·∫≠p (30 ng√†y) d·ª±a tr√™n gi√° tr·ªã hi·ªán t·∫°i.
    D√πng h√†m sin + random noise ƒë·ªÉ bi·ªÉu ƒë·ªì nh√¨n 'nh·∫•p nh√¥' t·ª± nhi√™n.
    """
    dates = [datetime.date.today() - timedelta(days=i) for i in range(days)]
    dates.reverse() # X·∫øp t·ª´ qu√° kh·ª© ƒë·∫øn hi·ªán t·∫°i
    
    # Base values
    base_temp = base_row['temperature_celsius']
    base_hum = base_row['humidity']
    base_pm25 = base_row['air_quality_PM2.5']
    
    data = []
    for i, date in enumerate(dates):
        # T·∫°o bi·∫øn ƒë·ªông gi·∫£ l·∫≠p
        # Noise ng·∫´u nhi√™n
        noise_temp = np.random.normal(0, 1.5)
        noise_hum = np.random.normal(0, 5)
        noise_pm25 = np.random.normal(0, 8)
        
        # Trend (Sine wave) ƒë·ªÉ t·∫°o xu h∆∞·ªõng
        trend = np.sin(i / 5) * 2 
        
        row = {
            'date': date,
            'temp': base_temp + trend + noise_temp,
            'humidity': max(10, min(100, base_hum - trend*2 + noise_hum)), # ƒê·ªô ·∫©m th∆∞·ªùng ng∆∞·ª£c chi·ªÅu nhi·ªát ƒë·ªô
            'pm25': max(5, base_pm25 + noise_pm25)
        }
        data.append(row)
        
    return pd.DataFrame(data)

df_health, df_weather = load_data()

# --- 3. SIDEBAR ---
with st.sidebar:
    st.title("üéõÔ∏è Control Panel")
    
    # Ch·ªçn ƒë·ªãa ƒëi·ªÉm
    if df_weather is not None:
        countries = sorted(df_weather['country'].unique().tolist())
        default_idx = countries.index('Vietnam') if 'Vietnam' in countries else 0
        selected_country = st.selectbox("Select Country", countries, index=default_idx)
        
        country_data = df_weather[df_weather['country'] == selected_country]
        
        cities = sorted(country_data['location_name'].unique().tolist())
        selected_city = st.selectbox("Select City", cities)
        
        # L·∫•y d√≤ng d·ªØ li·ªáu hi·ªán t·∫°i c·ªßa th√†nh ph·ªë ƒë∆∞·ª£c ch·ªçn
        current_data_row = country_data[country_data['location_name'] == selected_city].iloc[0]

# --- 4. MAIN DASHBOARD ---
if df_weather is not None:
    st.markdown(f"## üìç Weather Analysis: **{selected_city}, {selected_country}**")
    
    # T·∫°o d·ªØ li·ªáu l·ªãch s·ª≠ 30 ng√†y cho th√†nh ph·ªë n√†y
    df_history = generate_historical_data(current_data_row, days=30)
    
    tab1, tab2, tab3 = st.tabs(["üìä Historical Analysis (30 Days)", "üîÆ AI Forecast (Tomorrow)", "üè• Health Risk Model"])

    # === TAB 1: 30-DAY CHARTS (THE REAL LOOK) ===
    with tab1:
        # 1. Metrics Row
        c1, c2, c3, c4 = st.columns(4)
        with c1: st.metric("Avg Temp (30d)", f"{df_history['temp'].mean():.1f}¬∞C", f"{df_history['temp'].iloc[-1] - df_history['temp'].iloc[0]:.1f}")
        with c2: st.metric("Current Humidity", f"{current_data_row['humidity']}%")
        with c3: st.metric("Current PM2.5", f"{current_data_row['air_quality_PM2.5']}", delta_color="inverse")
        with c4: st.metric("Wind Speed", f"{current_data_row['wind_kph']} km/h")
        
        st.markdown("### üìà 30-Day Trend Analysis")
        
        # 2. Main Chart: Temperature vs Humidity (Dual Axis) - X·ªäN H∆†N
        fig_combo = make_subplots(specs=[[{"secondary_y": True}]])

        # Trace 1: Temperature (Area Chart - Gradient)
        fig_combo.add_trace(
            go.Scatter(x=df_history['date'], y=df_history['temp'], name="Temperature (¬∞C)",
                       mode='lines', line=dict(color='#ff9f43', width=3), fill='tozeroy', fillcolor='rgba(255, 159, 67, 0.1)'),
            secondary_y=False
        )
        
        # Trace 2: Humidity (Bar Chart - Th·∫•p tho√°ng ph√≠a sau)
        fig_combo.add_trace(
            go.Bar(x=df_history['date'], y=df_history['humidity'], name="Humidity (%)",
                   marker_color='rgba(52, 152, 219, 0.3)'),
            secondary_y=True
        )

        fig_combo.update_layout(
            template="plotly_dark", # Quan tr·ªçng: Dark theme cho chart
            title_text="Temperature vs Humidity Correlation",
            height=450,
            hovermode="x unified",
            paper_bgcolor='rgba(0,0,0,0)', # Trong su·ªët n·ªÅn
            plot_bgcolor='rgba(0,0,0,0)',
            legend=dict(orientation="h", y=1.1)
        )
        fig_combo.update_yaxes(title_text="Temperature (¬∞C)", secondary_y=False, showgrid=True, gridcolor='#333')
        fig_combo.update_yaxes(title_text="Humidity (%)", secondary_y=True, showgrid=False)
        st.plotly_chart(fig_combo, use_container_width=True)
        
        # 3. Secondary Chart: Air Quality (PM2.5) Line Chart
        st.markdown("### üå´Ô∏è Air Quality History")
        fig_air = go.Figure()
        fig_air.add_trace(go.Scatter(
            x=df_history['date'], y=df_history['pm25'],
            mode='lines+markers',
            name='PM2.5',
            line=dict(color='#ef5777', width=2),
            marker=dict(size=6, color='#ef5777', line=dict(width=2, color='white'))
        ))
        
        # Th√™m c√°c v·∫°ch ng∆∞·ª°ng nguy hi·ªÉm
        fig_air.add_hrect(y0=0, y1=12, line_width=0, fillcolor="green", opacity=0.1, annotation_text="Good")
        fig_air.add_hrect(y0=12, y1=35, line_width=0, fillcolor="yellow", opacity=0.1, annotation_text="Moderate")
        fig_air.add_hrect(y0=35, y1=100, line_width=0, fillcolor="red", opacity=0.1, annotation_text="Unhealthy")

        fig_air.update_layout(
            template="plotly_dark",
            height=350,
            paper_bgcolor='rgba(0,0,0,0)',
            plot_bgcolor='rgba(0,0,0,0)',
            xaxis_title="Date",
            yaxis_title="PM2.5 Concentration (¬µg/m¬≥)"
        )
        st.plotly_chart(fig_air, use_container_width=True)

    # === TAB 2: FORECAST ===
    with tab2:
        st.subheader("üå§Ô∏è 24-Hour AI Forecast")
        
        # Logic d·ª± b√°o gi·∫£ l·∫≠p (d·ª±a tr√™n trend cu·ªëi c√πng c·ªßa d·ªØ li·ªáu l·ªãch s·ª≠)
        last_temp = df_history['temp'].iloc[-1]
        next_temp = last_temp + np.random.uniform(-1, 2)
        next_hum = max(0, min(100, current_data_row['humidity'] + np.random.uniform(-5, 5)))
        next_pm25 = max(0, current_data_row['air_quality_PM2.5'] + np.random.uniform(-5, 10))
        
        # Condition logic
        if next_hum > 80: condition = "Rainy üåßÔ∏è"
        elif next_temp > 30: condition = "Sunny & Hot ‚òÄÔ∏è"
        elif next_pm25 > 50: condition = "Haze/Polluted üå´Ô∏è"
        else: condition = "Cloudy ‚òÅÔ∏è"

        # Display Forecast Cards
        col1, col2, col3, col4 = st.columns(4)
        col1.metric("Predicted Temp", f"{next_temp:.1f}¬∞C", f"{(next_temp - last_temp):.1f}¬∞C")
        col2.metric("Predicted Humidity", f"{next_hum:.0f}%")
        col3.metric("Predicted PM2.5", f"{next_pm25:.1f}")
        with col4:
            st.markdown(f"#### {condition}")
            
        # L∆∞u v√†o session state ƒë·ªÉ Tab 3 d√πng
        st.session_state['forecast'] = {'temp': next_temp, 'pm25': next_pm25, 'hum': next_hum}
        
        st.info("üí° Note: Forecast generated using heuristic projection based on 30-day historical trend analysis.")

    # === TAB 3: HEALTH PREDICTION ===
    with tab3:
        st.subheader("üè• Disease Risk Prediction Model")
        
        if 'forecast' in st.session_state:
            f = st.session_state['forecast']
            
            # --- MODEL TRAINING (·∫®n b√™n d∆∞·ªõi) ---
            # Train model th·∫≠t v·ªõi dataset 1
            X = df_health[['temperature_celsius', 'pm25_ugm3']]
            # Fill NaN n·∫øu c√≥ ƒë·ªÉ tr√°nh l·ªói
            X = X.fillna(0)
            y_resp = df_health['respiratory_disease_rate']
            y_cardio = df_health['cardio_mortality_rate']
            
            model_resp = RandomForestRegressor(n_estimators=100).fit(X, y_resp)
            model_cardio = RandomForestRegressor(n_estimators=100).fit(X, y_cardio)
            
            # Predict
            input_val = pd.DataFrame([[f['temp'], f['pm25']]], columns=['temperature_celsius', 'pm25_ugm3'])
            risk_resp = model_resp.predict(input_val)[0]
            risk_cardio = model_cardio.predict(input_val)[0]
            
            # --- VISUALIZATION ---
            st.write("Predicted health risks per 100,000 population based on forecasted weather:")
            
            c1, c2 = st.columns(2)
            
            # Custom HTML Progress Bar cho ƒë·∫πp
            def draw_risk(title, val, max_val, color):
                pct = min(100, (val/max_val)*100)
                st.markdown(f"""
                <div style="background-color: #1a1c24; padding: 20px; border-radius: 10px; border: 1px solid #333;">
                    <h4 style="margin:0; color: #eee;">{title}</h4>
                    <h2 style="margin: 5px 0; color: {color};">{val:.1f}</h2>
                    <div style="width: 100%; background-color: #333; height: 10px; border-radius: 5px; margin-top: 10px;">
                        <div style="width: {pct}%; background-color: {color}; height: 100%; border-radius: 5px;"></div>
                    </div>
                    <p style="margin-top: 5px; font-size: 0.8em; color: #888;">Threshold: {max_val}</p>
                </div>
                """, unsafe_allow_html=True)

            with c1:
                color = "#ff4757" if risk_resp > 30 else "#2ed573"
                draw_risk("ü´Å Respiratory Disease Risk", risk_resp, 60, color)
                
            with c2:
                color = "#ffa502" if risk_cardio > 20 else "#2ed573"
                draw_risk("‚ù§Ô∏è Cardiovascular Risk", risk_cardio, 50, color)
                
            st.markdown("---")
            st.markdown(f"**Analysis Basis:** Forecasted Temperature: **{f['temp']:.1f}¬∞C** | PM2.5: **{f['pm25']:.1f} ¬µg/m¬≥**")

        else:
            st.warning("Please check the Forecast tab first to generate data.")

else:
    st.info("Loading data...")



================================================
FILE: update-dataset.py
================================================
import os
from dotenv import load_dotenv
load_dotenv()

print("Updating dataset...")

# Thi·∫øt l·∫≠p bi·∫øn m√¥i tr∆∞·ªùng cho Kaggle API
os.environ['KAGGLE_USERNAME'] = os.getenv('KAGGLE_USERNAME')
os.environ['KAGGLE_KEY'] = os.getenv('KAGGLE_KEY')

# T·∫°o file c·∫•u h√¨nh cho Kaggle n·∫øu ch∆∞a c√≥
kaggle_dir = os.path.expanduser('~/.kaggle')
os.makedirs(kaggle_dir, exist_ok=True)
with open(os.path.join(kaggle_dir, 'kaggle.json'), 'w') as f:
    import json
    json.dump({
        'username': os.environ['KAGGLE_USERNAME'],
        'key': os.environ['KAGGLE_KEY']
    }, f)
os.chmod(os.path.join(kaggle_dir, 'kaggle.json'), 0o600)

import kaggle

# T·∫£i dataset (t·ª± ƒë·ªông gi·∫£i n√©n)
kaggle.api.dataset_download_files(
    'nelgiriyewithana/global-weather-repository',  # Thay b·∫±ng dataset b·∫°n mu·ªën
    path='./data',
    unzip=True
)

print("Finish!")


================================================
FILE: weather_information.ipynb
================================================
# Jupyter notebook converted to Python script.

"""
## Import th∆∞ vi·ªán
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

# TRAIN
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error, r2_score
from sklearn.ensemble import RandomForestRegressor

df = pd.read_csv('data/GlobalWeatherRepository.csv')
df.head()
df.columns
# Output:
#   Index(['country', 'location_name', 'latitude', 'longitude', 'timezone',

#          'last_updated_epoch', 'last_updated', 'temperature_celsius',

#          'temperature_fahrenheit', 'condition_text', 'wind_mph', 'wind_kph',

#          'wind_degree', 'wind_direction', 'pressure_mb', 'pressure_in',

#          'precip_mm', 'precip_in', 'humidity', 'cloud', 'feels_like_celsius',

#          'feels_like_fahrenheit', 'visibility_km', 'visibility_miles',

#          'uv_index', 'gust_mph', 'gust_kph', 'air_quality_Carbon_Monoxide',

#          'air_quality_Ozone', 'air_quality_Nitrogen_dioxide',

#          'air_quality_Sulphur_dioxide', 'air_quality_PM2.5', 'air_quality_PM10',

#          'air_quality_us-epa-index', 'air_quality_gb-defra-index', 'sunrise',

#          'sunset', 'moonrise', 'moonset', 'moon_phase', 'moon_illumination'],

#         dtype='object')

df['last_updated'] = pd.to_datetime(df['last_updated'])
daily_stats = df.groupby(df['last_updated'].dt.date).mean(numeric_only=True).tail(30)

# L·∫§Y THEO KHU V·ª∞C
region = 'Vietnam'
df = df[(df['country'] == region) & (df['location_name'] == "Hanoi")]

fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(10, 8), sharex=True)

ax1.plot(daily_stats.index, daily_stats['temperature_celsius'], 'r-o')
ax1.set_ylabel('Nhi·ªát ƒë·ªô (¬∞C)')
ax1.set_title('Nhi·ªát ƒë·ªô trung b√¨nh 30 ng√†y')

ax2.plot(daily_stats.index, daily_stats['air_quality_PM2.5'], 'b-s')
ax2.set_ylabel('PM 2.5')
ax2.set_title('Ch·∫•t l∆∞·ª£ng kh√¥ng kh√≠ (PM 2.5) 30 ng√†y')

plt.xticks(rotation=45)
plt.tight_layout()
plt.show()
# Output:
#   <Figure size 1000x800 with 2 Axes>

# ƒê·∫øm s·ªë l·∫ßn xu·∫•t hi·ªán c·ªßa c√°c lo·∫°i th·ªùi ti·∫øt
condition_counts = df['condition_text'].value_counts().head(10)

# V·∫Ω bi·ªÉu ƒë·ªì c·ªôt
condition_counts.plot(kind='barh', color='orange', figsize=(10, 5))
plt.title('Top 10 ƒëi·ªÅu ki·ªán th·ªùi ti·∫øt ph·ªï bi·∫øn nh·∫•t')
plt.xlabel('S·ªë l∆∞·ª£ng ƒë·ªãa ƒëi·ªÉm')
plt.show()
# Output:
#   <Figure size 1000x500 with 1 Axes>

"""
## M√¥ h√¨nh d·ª± ƒëo√°n
"""

# TRAIN MODEL
df['hour'] = df['last_updated'].dt.hour
features = ['latitude', 'humidity', 'pressure_mb', 'wind_kph', 'cloud', 'hour']
# data = df.sort_values('last_updated').tail(10000)
data = df.sort_values('last_updated')

X = data[features]
y = data['temperature_celsius']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
model = RandomForestRegressor(n_estimators=100, random_state=42) # n_estimators l√† s·ªë c√¢y trong r·ª´ng, random_state ƒë·ªÉ t√°i l·∫≠p k·∫øt qu·∫£
model.fit(X_train, y_train)

y_pred = model.predict(X_test)
rmse = np.sqrt(mean_squared_error(y_test, y_pred))
r2 = r2_score(y_test, y_pred)

print(f"RMSE: {rmse:.2f}¬∞C | R¬≤: {r2:.2f}")
# Output:
#   RMSE: 1.77¬∞C | R¬≤: 0.90


import matplotlib.pyplot as plt

plt.figure(figsize=(8, 6))
plt.scatter(y_test, y_pred, alpha=0.5, color='darkgreen')
plt.plot([y_test.min(), y_test.max()], [y_test.min(), y_test.max()], 'r--', lw=2)

plt.xlabel('Nhi·ªát ƒë·ªô th·ª±c t·∫ø (¬∞C)')
plt.ylabel('Nhi·ªát ƒë·ªô d·ª± ƒëo√°n (¬∞C)')
plt.show()
# Output:
#   <Figure size 800x600 with 1 Axes>

import pandas as pd
feat_importances = pd.Series(model.feature_importances_, index=features)
feat_importances.nlargest(10).plot(kind='barh')
plt.title('Y·∫øu t·ªë n√†o ·∫£nh h∆∞·ªüng ƒë·∫øn nhi·ªát ƒë·ªô nh·∫•t?')
plt.show()
# Output:
#   <Figure size 640x480 with 1 Axes>

# D·ª± ƒëo√°n nhi·ªát ƒë·ªô m·ªõi d√πng d·ªØ li·ªáu realtime c·ªßa open-metro
import requests
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from datetime import datetime

LAT, LON = 21.02, 105.83  # T·ªça ƒë·ªô H√† N·ªôi
url = f"https://api.open-meteo.com/v1/forecast?latitude={LAT}&longitude={LON}&current=relative_humidity_2m,surface_pressure,wind_speed_10m,cloud_cover&timezone=auto"


response = requests.get(url)
data_json = response.json()
current = data_json['current']
new_data = pd.DataFrame([{
    'latitude': LAT,
    'humidity': current['relative_humidity_2m'],
    'pressure_mb': current['surface_pressure'],
    'wind_kph': current['wind_speed_10m'] * 3.6,  # m/s to km/h
    'cloud': current['cloud_cover'],
    'hour': datetime.now().hour
}])
new_data

predictions = model.predict(new_data)
print(f"D·ª± ƒëo√°n nhi·ªát ƒë·ªô (trung b√¨nh): {predictions[0]:.2f}¬∞C")
print(f"D·ª± ƒëo√°n nhi·ªát ƒë·ªô (min): {(predictions[0] - rmse):.2f}¬∞C")
print(f"D·ª± ƒëo√°n nhi·ªát ƒë·ªô (max): {(predictions[0] + rmse):.2f}¬∞C")
# Output:
#   D·ª± ƒëo√°n nhi·ªát ƒë·ªô (trung b√¨nh): 20.35¬∞C

#   D·ª± ƒëo√°n nhi·ªát ƒë·ªô (min): 18.57¬∞C

#   D·ª± ƒëo√°n nhi·ªát ƒë·ªô (max): 22.12¬∞C




================================================
FILE: data/global_climate_health_impact_tracker_2015_2025.csv
================================================
record_id,country_code,country_name,region,income_level,date,year,month,week,latitude,longitude,population_millions,temperature_celsius,temp_anomaly_celsius,precipitation_mm,heat_wave_days,drought_indicator,flood_indicator,extreme_weather_events,pm25_ugm3,air_quality_index,respiratory_disease_rate,cardio_mortality_rate,vector_disease_risk_score,waterborne_disease_incidents,heat_related_admissions,healthcare_access_index,gdp_per_capita_usd,mental_health_index,food_security_index
1,USA,United States,North America,High,2015-01-04,2015,1,1,37.09,-95.71,331,4.59,0.76,75.7,0,0,0,0,39.0,82.0,69.4,31.5,6.6,16.2,1.4,77.3,63627.0,71.2,90.2
2,USA,United States,North America,High,2015-01-11,2015,1,2,37.09,-95.71,331,3.13,-0.5,97.0,0,0,0,0,17.9,6.0,70.0,26.3,5.2,11.4,0.0,83.6,63627.0,70.6,94.0
3,USA,United States,North America,High,2015-01-18,2015,1,3,37.09,-95.71,331,3.99,-0.14,74.1,0,0,0,0,91.5,137.0,66.9,33.4,1.3,19.5,0.0,84.7,63627.0,63.4,100.0
4,USA,United States,North America,High,2015-01-25,2015,1,4,37.09,-95.71,331,6.43,-0.06,87.7,0,0,0,0,5.5,-3.0,47.0,35.0,6.0,9.7,9.0,84.3,63627.0,68.1,96.4
5,USA,United States,North America,High,2015-02-01,2015,2,5,37.09,-95.71,331,9.0,0.47,75.8,1,0,0,1,37.1,48.0,61.3,28.3,1.4,22.6,27.3,83.6,63733.0,69.1,100.0
6,USA,United States,North America,High,2015-02-08,2015,2,6,37.09,-95.71,331,6.44,0.18,151.0,0,0,0,0,114.1,157.0,80.2,30.6,0.7,23.7,11.9,78.0,63733.0,70.1,97.1
7,USA,United States,North America,High,2015-02-15,2015,2,7,37.09,-95.71,331,6.86,0.38,102.1,0,0,0,0,28.9,51.0,70.3,33.2,5.9,25.4,9.1,81.7,63733.0,68.5,100.0
8,USA,United States,North America,High,2015-02-22,2015,2,8,37.09,-95.71,331,8.34,0.64,102.9,1,0,0,1,0.0,5.0,48.0,33.3,6.4,17.7,20.3,86.7,63733.0,59.4,95.0
9,USA,United States,North America,High,2015-03-01,2015,3,9,37.09,-95.71,331,9.58,-0.83,82.2,0,0,0,0,18.8,29.0,80.3,24.9,5.9,18.3,7.8,84.9,63839.0,75.7,100.0
10,USA,United States,North America,High,2015-03-08,2015,3,10,37.09,-95.71,331,8.25,0.71,74.5,1,0,0,1,20.3,22.0,59.1,32.5,0.3,18.8,13.7,87.1,63839.0,71.9,95.2
11,USA,United States,North America,High,2015-03-15,2015,3,11,37.09,-95.71,331,8.83,-0.16,142.7,1,0,0,1,0.7,-23.0,54.1,32.0,7.3,12.3,13.6,83.2,63839.0,72.1,100.0
12,USA,United States,North America,High,2015-03-22,2015,3,12,37.09,-95.71,331,11.32,-0.34,126.3,0,0,0,0,40.4,73.0,63.9,22.2,8.1,25.1,20.8,79.1,63839.0,65.2,96.0
13,USA,United States,North America,High,2015-03-29,2015,3,13,37.09,-95.71,331,12.28,0.64,132.7,0,0,0,0,57.0,82.0,59.6,28.7,2.6,18.1,20.8,82.5,63839.0,71.4,100.0
14,USA,United States,North America,High,2015-04-05,2015,4,14,37.09,-95.71,331,13.64,-0.13,201.5,0,0,0,0,0.0,7.0,47.8,32.9,6.4,18.1,17.6,85.1,63945.0,62.4,97.5
15,USA,United States,North America,High,2015-04-12,2015,4,15,37.09,-95.71,331,11.04,-0.62,124.5,0,0,0,0,44.7,71.0,55.3,32.2,5.2,22.9,21.9,85.2,63945.0,65.2,100.0
16,USA,United States,North America,High,2015-04-19,2015,4,16,37.09,-95.71,331,9.17,0.16,125.9,1,0,0,1,70.8,106.0,86.5,37.2,5.7,19.4,15.1,79.9,63945.0,62.0,100.0
17,USA,United States,North America,High,2015-04-26,2015,4,17,37.09,-95.71,331,9.96,-0.26,62.8,0,0,0,0,56.4,77.0,77.8,29.0,1.8,14.9,17.8,82.6,63945.0,66.3,100.0
18,USA,United States,North America,High,2015-05-03,2015,5,18,37.09,-95.71,331,8.29,1.08,133.2,2,0,0,2,59.6,80.0,67.4,30.1,2.7,26.8,25.4,77.7,64051.0,67.4,100.0
19,USA,United States,North America,High,2015-05-10,2015,5,19,37.09,-95.71,331,10.93,0.64,122.7,1,0,0,1,76.7,104.0,62.2,33.5,10.6,18.4,19.7,76.5,64051.0,63.0,99.2
20,USA,United States,North America,High,2015-05-17,2015,5,20,37.09,-95.71,331,5.8,0.78,147.9,0,0,0,0,27.2,34.0,58.7,45.6,6.2,23.1,5.1,82.9,64051.0,70.3,100.0
21,USA,United States,North America,High,2015-05-24,2015,5,21,37.09,-95.71,331,3.88,0.65,86.2,0,0,0,0,95.6,154.0,79.4,35.4,4.7,16.1,3.3,80.6,64051.0,74.4,97.4
22,USA,United States,North America,High,2015-05-31,2015,5,22,37.09,-95.71,331,6.17,0.48,144.2,0,0,0,0,40.2,69.0,55.8,36.8,6.7,15.0,0.0,86.0,64051.0,63.9,96.4
23,USA,United States,North America,High,2015-06-07,2015,6,23,37.09,-95.71,331,9.14,-0.21,84.1,1,0,0,1,49.7,67.0,76.4,29.3,7.6,17.1,17.7,77.1,64157.0,79.1,100.0
24,USA,United States,North America,High,2015-06-14,2015,6,24,37.09,-95.71,331,4.24,0.61,56.0,0,0,0,0,68.1,112.0,63.4,33.0,0.0,27.4,1.4,86.6,64157.0,74.0,100.0
25,USA,United States,North America,High,2015-06-21,2015,6,25,37.09,-95.71,331,3.33,0.11,104.0,0,0,0,0,61.0,109.0,63.5,27.2,9.1,8.3,9.0,80.4,64157.0,68.5,99.7
26,USA,United States,North America,High,2015-06-28,2015,6,26,37.09,-95.71,331,3.14,0.65,105.5,0,0,0,0,51.2,78.0,50.9,29.0,4.0,20.8,1.1,82.7,64157.0,74.9,100.0
27,USA,United States,North America,High,2015-07-05,2015,7,27,37.09,-95.71,331,6.83,0.21,64.6,0,0,0,0,93.6,158.0,96.2,30.5,7.9,11.2,12.1,85.6,64263.0,69.2,93.0
28,USA,United States,North America,High,2015-07-12,2015,7,28,37.09,-95.71,331,-2.3,-0.94,83.7,0,0,0,0,57.5,101.0,74.7,32.7,7.1,17.8,0.0,79.2,64263.0,68.6,100.0
29,USA,United States,North America,High,2015-07-19,2015,7,29,37.09,-95.71,331,1.07,-0.03,76.4,0,0,0,0,51.7,41.0,56.5,29.3,4.8,19.8,0.0,81.6,64263.0,77.6,100.0
30,USA,United States,North America,High,2015-07-26,2015,7,30,37.09,-95.71,331,-3.72,-0.67,79.7,0,0,0,0,70.6,129.0,62.9,25.1,5.7,28.7,0.0,86.0,64263.0,77.8,100.0
31,USA,United States,North America,High,2015-08-02,2015,8,31,37.09,-95.71,331,0.68,0.1,28.7,0,1,0,1,47.5,81.0,77.9,25.7,7.1,23.8,0.0,81.7,64368.0,61.1,74.6
32,USA,United States,North America,High,2015-08-09,2015,8,32,37.09,-95.71,331,-0.73,0.76,57.6,0,0,0,0,89.2,113.0,59.7,33.5,6.2,18.3,0.0,84.5,64368.0,69.6,93.2
33,USA,United States,North America,High,2015-08-16,2015,8,33,37.09,-95.71,331,-2.15,-0.46,36.4,0,0,0,0,26.2,38.0,67.4,22.8,6.5,15.9,0.0,80.8,64368.0,69.5,94.6
34,USA,United States,North America,High,2015-08-23,2015,8,34,37.09,-95.71,331,-5.92,1.0,49.6,0,0,0,0,32.6,52.0,58.7,33.9,6.8,22.3,0.0,75.6,64368.0,67.1,98.4
35,USA,United States,North America,High,2015-08-30,2015,8,35,37.09,-95.71,331,-7.11,0.7,95.2,0,0,0,0,34.7,61.0,63.5,48.9,8.4,17.9,0.0,80.2,64368.0,62.0,100.0


================================================
FILE: data/GlobalWeatherRepository.csv
================================================
country,location_name,latitude,longitude,timezone,last_updated_epoch,last_updated,temperature_celsius,temperature_fahrenheit,condition_text,wind_mph,wind_kph,wind_degree,wind_direction,pressure_mb,pressure_in,precip_mm,precip_in,humidity,cloud,feels_like_celsius,feels_like_fahrenheit,visibility_km,visibility_miles,uv_index,gust_mph,gust_kph,air_quality_Carbon_Monoxide,air_quality_Ozone,air_quality_Nitrogen_dioxide,air_quality_Sulphur_dioxide,air_quality_PM2.5,air_quality_PM10,air_quality_us-epa-index,air_quality_gb-defra-index,sunrise,sunset,moonrise,moonset,moon_phase,moon_illumination
Afghanistan,Kabul,34.52,69.18,Asia/Kabul,1715849100,2024-05-16 13:15,26.6,79.8,Partly Cloudy,8.3,13.3,338,NNW,1012.0,29.89,0.0,0.0,24,30,25.3,77.5,10.0,6.0,7.0,9.5,15.3,277.0,103.0,1.1,0.2,8.4,26.6,1,1,04:50 AM,06:50 PM,12:12 PM,01:11 AM,Waxing Gibbous,55
Albania,Tirana,41.33,19.82,Europe/Tirane,1715849100,2024-05-16 10:45,19.0,66.2,Partly cloudy,6.9,11.2,320,NW,1012.0,29.88,0.1,0.0,94,75,19.0,66.2,10.0,6.0,5.0,11.4,18.4,193.6,97.3,0.9,0.1,1.1,2.0,1,1,05:21 AM,07:54 PM,12:58 PM,02:14 AM,Waxing Gibbous,55
Algeria,Algiers,36.76,3.05,Africa/Algiers,1715849100,2024-05-16 09:45,23.0,73.4,Sunny,9.4,15.1,280,W,1011.0,29.85,0.0,0.0,29,0,24.6,76.4,10.0,6.0,5.0,13.9,22.3,540.7,12.2,65.1,13.4,10.4,18.4,1,1,05:40 AM,07:50 PM,01:15 PM,02:14 AM,Waxing Gibbous,55
Andorra,Andorra La Vella,42.5,1.52,Europe/Andorra,1715849100,2024-05-16 10:45,6.3,43.3,Light drizzle,7.4,11.9,215,SW,1007.0,29.75,0.3,0.01,61,100,3.8,38.9,2.0,1.0,2.0,8.5,13.7,170.2,64.4,1.6,0.2,0.7,0.9,1,1,06:31 AM,09:11 PM,02:12 PM,03:31 AM,Waxing Gibbous,55
Angola,Luanda,-8.84,13.23,Africa/Luanda,1715849100,2024-05-16 09:45,26.0,78.8,Partly cloudy,8.1,13.0,150,SSE,1011.0,29.85,0.0,0.0,89,50,28.7,83.6,10.0,6.0,8.0,12.5,20.2,2964.0,19.0,72.7,31.5,183.4,262.3,5,10,06:12 AM,05:55 PM,01:17 PM,12:38 AM,Waxing Gibbous,55
Antigua and Barbuda,Saint John's,17.12,-61.85,America/Antigua,1715849100,2024-05-16 04:45,26.0,78.8,Partly cloudy,5.6,9.0,90,E,1013.0,29.91,0.02,0.0,84,25,28.2,82.8,10.0,6.0,1.0,15.7,25.3,220.3,29.0,0.2,0.2,1.2,4.5,1,1,05:36 AM,06:32 PM,01:05 PM,01:14 AM,Waxing Gibbous,55
Argentina,Buenos Aires,-34.59,-58.67,America/Argentina/Buenos_Aires,1715849100,2024-05-16 05:45,8.0,46.4,Clear,2.2,3.6,10,N,1014.0,29.94,0.0,0.0,93,0,7.1,44.9,10.0,6.0,1.0,6.5,10.5,270.4,7.7,8.3,1.3,4.0,5.3,1,1,07:43 AM,05:59 PM,02:36 PM,01:04 AM,Waxing Gibbous,55
Armenia,Yerevan,40.18,44.51,Asia/Yerevan,1715849100,2024-05-16 12:45,19.0,66.2,Partly cloudy,4.3,6.8,140,SE,1017.0,30.03,0.13,0.01,40,25,19.0,66.2,10.0,6.0,4.0,6.2,9.9,186.9,103.0,1.0,0.3,0.8,0.9,1,1,05:45 AM,08:12 PM,01:17 PM,02:31 AM,Waxing Gibbous,55
Australia,Canberra,-35.28,149.22,Australia/Sydney,1715849100,2024-05-16 18:45,9.0,48.2,Clear,2.5,4.0,100,E,1027.0,30.33,0.0,0.0,87,0,9.1,48.5,10.0,6.0,1.0,3.3,5.3,277.0,26.8,15.1,1.0,3.7,5.4,1,1,06:52 AM,05:07 PM,01:31 PM,No moonset,Waxing Gibbous,55